import pandas as pd

class Data:

    def __init__(self, dataframe):
        self.dataframe = dataframe

    def __str__(self):
        return f"\nStatistical summary of the data: \n============================={self.dataframe.describe()}." \
               f"\n\nShape of the data: {self.dataframe.shape}\n\n" \
               f"Missing values:\n============================= \n{self.dataframe.isnull().any()}"

    def missing_values(self):
        for i in self.dataframe:
            dt = self.dataframe[i].dtype
            if dt == object:
                self.dataframe[i] = self.dataframe[i].fillna("")

            else:
                self.dataframe[i] = self.dataframe[i].fillna(0)

        return self.dataframe


class GetExcelFormat(Data):
    def __init__(self, dataframe, path_to_xlsx):
        Data.__init__(self, dataframe)
        self.path_to_xlsx = path_to_xlsx

    def __str__(self):
        return "\nFile Path is: " + self.file_path + "\nDataFrame: " + self.dataframe + " \nwith Columns: " + self.dataframe.columns + \
                "\nShape: " + self.dataframe.shape + "\nStatistical Summary: " + self.dataframe.describe()

    """ Formats the column headers to be bold and vertical by writing the dataframe to excel file.
        Then creating a Workbook and Worksheet object in order to do the formatting. """
    @classmethod
    def format_workbook(cls, name_of_sheet):
        with pd.ExcelWriter(cls.path_to_xlsx) as writer:
            cls.dataframe.to_excel(writer, startrow=1, header=False, index=False, sheet_name=name_of_sheet)

            cls.workbook = writer.book
            cls.worksheet = cls.workbook[name_of_sheet]

            header_format = cls.workbook.add_format({
                'bold': True,
                'align': 'center',
                'font_color': 'black'
            })
            header_format.set_rotation(90)

            for col, val in enumerate(cls.dataframe.columns.values):
                cls.worksheet.write(0, col, val, header_format)


